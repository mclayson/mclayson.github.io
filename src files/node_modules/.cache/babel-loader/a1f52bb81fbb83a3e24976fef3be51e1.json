{"ast":null,"code":"import _classCallCheck from \"/Users/matt/Work/Projul/projul-prototype/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/matt/Work/Projul/projul-prototype/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/matt/Work/Projul/projul-prototype/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/matt/Work/Projul/projul-prototype/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/matt/Work/Projul/projul-prototype/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/matt/Work/Projul/projul-prototype/src/components/user-heatmap.js\";\nimport React from 'react';\nimport { WEEKEND, DAILY_WORK_HOURS } from '../config/account-settings';\nimport { DaysInMonth, SameDay } from '../utilities/date';\nimport { ProjectList } from '../utilities/content';\n\nvar Scheduler =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Scheduler, _React$Component);\n\n  function Scheduler() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Scheduler);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Scheduler)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      selected_day: 0,\n      tasks_by_day: []\n    };\n\n    _this.generateTasks = function () {\n      var tasks_by_day = [];\n      var tasks_by_id = {};\n      var today = new Date();\n      var next_week = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 7);\n      var past_number_chart = [3, 8, 8, 0, 7, 1, 7, 7, 5, 6, 6, 5, 5, 6, 7, 8, 8, 8, 8];\n      var number_chart = [0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 5, 5, 6, 7, 8, 8, 8, 8];\n      var future_number_chart = [0, 0, 0, 0, 0, 1, 1, 2, 0, 3, 0, 5, 0, 0, 0, 0, 0, 0, 8];\n\n      for (var d = 0; d < DaysInMonth(_this.props.month, _this.props.year); d++) {\n        var day_tasks = [];\n        var current_date = new Date(_this.props.year, _this.props.month, d + 1);\n\n        if (_this.props.task.start_date && SameDay(_this.props.task.start_date, current_date) && _this.props.task.assigned_user === _this.props.user.user_id) {} // day_tasks.push(this.generateTask({...this.props.task}));\n        // RANDOMLY ASSIGN A NUMBER OF HOURS BASED ON IF THE CURRENT_DATE IS BEFORE TODAY, WITHIN A WEEK OR BEYOND A WEEK\n\n\n        var number_of_hours = current_date < today ? Math.min(past_number_chart[Math.floor(Math.random() * past_number_chart.length)], DAILY_WORK_HOURS) : current_date > next_week ? Math.min(future_number_chart[Math.floor(Math.random() * future_number_chart.length)], DAILY_WORK_HOURS) : Math.min(number_chart[Math.floor(Math.random() * number_chart.length)], DAILY_WORK_HOURS);\n        var number_of_tasks = Math.ceil(Math.random() * number_of_hours); //\n\n        if (number_of_hours > 0) {\n          var last_end_time = 6;\n\n          for (var t = 0; t < number_of_tasks; t++) {\n            var start_time = last_end_time + (Math.round(number_of_hours / number_of_tasks) + Math.random());\n            var end_time = start_time + number_of_hours / number_of_tasks;\n            var id = \"task-\" + d + \"-\" + t;\n            var task = {\n              start_date: new Date(_this.props.year, _this.props.month, d + 1, start_time),\n              end_date: new Date(_this.props.year, _this.props.month, d + 1, end_time, -Math.round(Math.random() * 10)),\n              assigned_user: _this.props.user.user_id,\n              project_data: ProjectList[Math.floor(Math.random() * ProjectList.length)],\n              name: \"Task\",\n              icon: \"fas fa-hammer\",\n              progress: 0,\n              id: id\n            };\n            day_tasks.push(task);\n            last_end_time = end_time;\n            tasks_by_id[id] = task;\n          }\n        }\n\n        tasks_by_day.push(day_tasks);\n      }\n\n      _this.setState({\n        tasks_by_id: tasks_by_id\n      });\n\n      return tasks_by_day;\n    };\n\n    _this.handleDayClick = function (e) {\n      var id = parseInt(e.currentTarget.dataset.id, 10);\n      var index = parseInt(e.currentTarget.dataset.index, 10);\n\n      _this.props.handleDayClick(id, index);\n    };\n\n    _this.handleTaskClick = function (e) {\n      var id = e.currentTarget.dataset.id;\n      var project_id = e.currentTarget.dataset.project;\n\n      _this.props.handleTaskClick(project_id, _this.state.tasks_by_id[id]);\n    };\n\n    return _this;\n  }\n\n  _createClass(Scheduler, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var tasks_by_day = this.generateTasks();\n      setTimeout(function () {\n        _this2.setState({\n          tasks_by_day: tasks_by_day\n        });\n      }, 100);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.month !== prevProps.month) {\n        this.setState({\n          tasks_by_day: this.generateTasks()\n        });\n      }\n\n      if (this.props.selected_day && this.props.selected_day !== prevProps.selected_day) {\n        this.setState({\n          selected_day: this.props.selected_day\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var cells = [];\n      var day_cells = [];\n      var classes = [\"tasks-0\", \"tasks-1\", \"tasks-2\", \"tasks-3\", \"tasks-4\", \"tasks-5\", \"tasks-6\", \"tasks-7\", \"tasks-8\"];\n\n      if (this.state.tasks_by_day && this.state.tasks_by_day.length === DaysInMonth(this.props.month, this.props.year)) {\n        for (var i = 0; i < DaysInMonth(this.props.month, this.props.year); i++) {\n          var current_date = new Date(this.props.year, this.props.month, i + 1);\n          var value = 0;\n\n          for (var t = 0; t < this.state.tasks_by_day[i].length; t++) {\n            var task = this.state.tasks_by_day[i][t];\n            var task_duration = (task.end_date - task.start_date) / 1000 / 60 / 60;\n            value += task_duration;\n          }\n\n          var weekend = \"\";\n\n          for (var w = 0; w < WEEKEND.length; w++) {\n            if (current_date.getDay() === WEEKEND[w]) {\n              value = 0;\n              weekend = \" weekend\";\n            }\n          }\n\n          cells.push(React.createElement(\"li\", {\n            key: this.props.user.user_id + \"_\" + i,\n            \"data-id\": i + 1,\n            \"data-index\": this.props.index,\n            className: \"cell \" + classes[Math.min(Math.round(value * 8 / DAILY_WORK_HOURS), classes.length - 1)] + weekend + (current_date.toDateString() === new Date().toDateString() || this.props.month / 20 + this.props.year > new Date().getMonth() / 20 + new Date().getFullYear() && i === 0 ? \" today\" : \"\") + (this.props.task.start_date && SameDay(this.props.task.start_date, current_date) && this.props.task.assigned_user === this.props.user.user_id ? \" assigned\" : \"\"),\n            onClick: this.handleDayClick,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          }, value ? Math.round(value * 10) / 10 + \" hrs\" : \"\"));\n        } // The Day view\n\n\n        if (this.state.selected_day && this.state.tasks_by_day[this.state.selected_day - 1]) {\n          for (var h = 0; h < 24; h++) {\n            // const current_time = new Date(this.props.year, this.props.month, this.state.selected_day, h);\n            day_cells.push(React.createElement(\"li\", {\n              key: \"hour-\" + h,\n              className: \"day-cell\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 153\n              },\n              __self: this\n            }));\n          } //Represent Tasks on Day View\n\n\n          for (t = 0; t < this.state.tasks_by_day[this.state.selected_day - 1].length; t++) {\n            var _task = this.state.tasks_by_day[this.state.selected_day - 1][t];\n\n            var _task_duration = (_task.end_date - _task.start_date) / 1000 / 60 / 60 / 24 * 100;\n\n            var task_start = (_task.start_date - new Date(this.props.year, this.props.month, this.state.selected_day)) / 1000 / 60 / 60 / 24 * 100;\n            day_cells.push(React.createElement(\"li\", {\n              key: \"task-\" + t,\n              \"data-id\": _task.id,\n              \"data-project\": _task.project_data.id,\n              className: \"task\",\n              style: {\n                left: task_start + \"%\",\n                maxWidth: _task_duration + \"%\",\n                backgroundColor: _task.project_data.color\n              },\n              onClick: this.handleTaskClick,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 169\n              },\n              __self: this\n            }, React.createElement(\"h4\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 185\n              },\n              __self: this\n            }, React.createElement(\"i\", {\n              className: _task.icon,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 186\n              },\n              __self: this\n            }), React.createElement(\"span\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 187\n              },\n              __self: this\n            }, React.createElement(\"strong\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 187\n              },\n              __self: this\n            }, _task.name))), React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 189\n              },\n              __self: this\n            }, _task.project_data.name)));\n          }\n        }\n      }\n\n      return React.createElement(\"ul\", {\n        className: this.props.selected_day ? \"show-day\" : \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        className: \"day-schedule\",\n        style: {\n          transformOrigin: this.state.selected_day / DaysInMonth(this.props.month, this.props.year) * 100 + \"% 0\",\n          transition: \"opacity .5s ease \" + Math.abs(this.props.index - this.props.selected_index) * .02 + \"s, transform .5s ease 1s\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, day_cells)), cells);\n    }\n  }]);\n\n  return Scheduler;\n}(React.Component);\n\nexport default Scheduler;","map":{"version":3,"sources":["/Users/matt/Work/Projul/projul-prototype/src/components/user-heatmap.js"],"names":["React","WEEKEND","DAILY_WORK_HOURS","DaysInMonth","SameDay","ProjectList","Scheduler","state","selected_day","tasks_by_day","generateTasks","tasks_by_id","today","Date","next_week","getFullYear","getMonth","getDate","past_number_chart","number_chart","future_number_chart","d","props","month","year","day_tasks","current_date","task","start_date","assigned_user","user","user_id","number_of_hours","Math","min","floor","random","length","number_of_tasks","ceil","last_end_time","t","start_time","round","end_time","id","end_date","project_data","name","icon","progress","push","setState","handleDayClick","e","parseInt","currentTarget","dataset","index","handleTaskClick","project_id","project","setTimeout","prevProps","cells","day_cells","classes","i","value","task_duration","weekend","w","getDay","toDateString","h","task_start","left","maxWidth","backgroundColor","color","transformOrigin","transition","abs","selected_index","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {WEEKEND, DAILY_WORK_HOURS} from '../config/account-settings'\nimport {DaysInMonth, SameDay} from '../utilities/date'\nimport {ProjectList} from '../utilities/content'\n\nclass Scheduler extends React.Component {\n  state = {\n    selected_day:0,\n    tasks_by_day:[]\n  };\n\n\n  generateTasks = () => {\n    let tasks_by_day = [];\n    let tasks_by_id = {};\n\n    const today = new Date();\n    const next_week = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 7);\n    const past_number_chart = [3,8,8,0,7,1,7,7,5,6,6,5,5,6,7,8,8,8,8];\n    const number_chart = [0,0,0,0,0,1,1,2,2,3,4,5,5,6,7,8,8,8,8];\n    const future_number_chart = [0,0,0,0,0,1,1,2,0,3,0,5,0,0,0,0,0,0,8];\n\n    for (var d=0; d<DaysInMonth(this.props.month, this.props.year); d++) {\n      let day_tasks = [];\n      const current_date = new Date(this.props.year, this.props.month, (d+1));\n      if (this.props.task.start_date && SameDay(this.props.task.start_date, current_date) && this.props.task.assigned_user === this.props.user.user_id) {\n        // day_tasks.push(this.generateTask({...this.props.task}));\n      }\n      // RANDOMLY ASSIGN A NUMBER OF HOURS BASED ON IF THE CURRENT_DATE IS BEFORE TODAY, WITHIN A WEEK OR BEYOND A WEEK\n      const number_of_hours = (current_date < today) ? Math.min(past_number_chart[Math.floor(Math.random()*past_number_chart.length)],DAILY_WORK_HOURS) :\n                              (current_date > next_week) ? Math.min(future_number_chart[Math.floor(Math.random()*future_number_chart.length)],DAILY_WORK_HOURS) :\n                              Math.min(number_chart[Math.floor(Math.random()*number_chart.length)],DAILY_WORK_HOURS);\n      const number_of_tasks = Math.ceil(Math.random()*number_of_hours)\n      //\n      if (number_of_hours>0) {\n        var last_end_time = 6;\n        for (var t=0; t<number_of_tasks; t++) {\n          var start_time = last_end_time+(Math.round(number_of_hours/number_of_tasks)+(Math.random()));\n          var end_time = start_time+(number_of_hours/number_of_tasks);\n          var id = \"task-\"+d+\"-\"+t;\n          var task = {\n            start_date: new Date(this.props.year, this.props.month, (d+1), start_time ),\n            end_date: new Date(this.props.year, this.props.month, (d+1), end_time, -Math.round(Math.random()*10) ),\n            assigned_user: this.props.user.user_id,\n            project_data: ProjectList[Math.floor(Math.random()*ProjectList.length)],\n            name: \"Task\",\n            icon: \"fas fa-hammer\",\n            progress: 0,\n            id: id\n          };\n          day_tasks.push(task);\n          last_end_time = end_time;\n          tasks_by_id[id] = task;\n        }\n      }\n      tasks_by_day.push(day_tasks);\n    }\n    this.setState({\n      tasks_by_id: tasks_by_id\n    })\n    return tasks_by_day;\n  }\n\n  componentDidMount() {\n    var tasks_by_day = this.generateTasks();\n    setTimeout(()=>{\n      this.setState({\n        tasks_by_day: tasks_by_day\n      });\n    }, 100);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.month !== prevProps.month) {\n      this.setState({\n        tasks_by_day: this.generateTasks()\n      });\n    }\n    if (this.props.selected_day && this.props.selected_day !== prevProps.selected_day) {\n      this.setState({\n        selected_day: this.props.selected_day\n      });\n    }\n  }\n\n  handleDayClick = (e) => {\n    const id=parseInt(e.currentTarget.dataset.id,10);\n    const index=parseInt(e.currentTarget.dataset.index,10);\n    this.props.handleDayClick(id, index);\n  }\n  handleTaskClick = (e) => {\n    const id=e.currentTarget.dataset.id;\n    const project_id=e.currentTarget.dataset.project;\n    this.props.handleTaskClick(project_id, this.state.tasks_by_id[id]);\n  }\n\n  render() {\n    const cells = [];\n    const day_cells = [];\n    const classes = [\n      \"tasks-0\",\n      \"tasks-1\",\n      \"tasks-2\",\n      \"tasks-3\",\n      \"tasks-4\",\n      \"tasks-5\",\n      \"tasks-6\",\n      \"tasks-7\",\n      \"tasks-8\"\n    ];\n\n    if (this.state.tasks_by_day && this.state.tasks_by_day.length === DaysInMonth(this.props.month, this.props.year)) {\n      for (var i=0; i<DaysInMonth(this.props.month, this.props.year); i++) {\n\n        const current_date = new Date(this.props.year, this.props.month, (i+1));\n        let value = 0;\n        for (var t=0; t<this.state.tasks_by_day[i].length; t++) {\n          const task = this.state.tasks_by_day[i][t];\n          const task_duration = (((task.end_date-task.start_date)/1000)/60/60);\n          value+=task_duration;\n        }\n        let weekend = \"\";\n\n        for (var w=0; w<WEEKEND.length; w++) {\n          if (current_date.getDay() === WEEKEND[w]) {\n            value = 0;\n            weekend = \" weekend\";\n          }\n        }\n        cells.push((\n          <li\n            key={this.props.user.user_id + \"_\" + i}\n            data-id={(i+1)}\n            data-index={(this.props.index)}\n            className={\"cell \" +\n              (classes[Math.min(Math.round(value*8/DAILY_WORK_HOURS),classes.length-1)]) +\n              weekend +\n              (((current_date.toDateString() === (new Date()).toDateString()) || (((this.props.month/20)+this.props.year) > (((new Date()).getMonth()/20)+(new Date()).getFullYear()) && i===0)) ? \" today\" : \"\") +\n              (this.props.task.start_date && SameDay(this.props.task.start_date, current_date) && this.props.task.assigned_user === this.props.user.user_id ? \" assigned\" : \"\")\n          } onClick={this.handleDayClick}\n          >{\n            value?(Math.round(value*10)/10)+\" hrs\":\"\"\n          }</li>\n        ));\n      }\n\n      // The Day view\n      if (this.state.selected_day && this.state.tasks_by_day[this.state.selected_day-1]) {\n\n        for (var h=0; h<24; h++) {\n          // const current_time = new Date(this.props.year, this.props.month, this.state.selected_day, h);\n          day_cells.push((\n            <li\n              key={\"hour-\"+h}\n              className={\n                \"day-cell\"\n              }\n            >\n            </li>\n          ));\n        }\n\n        //Represent Tasks on Day View\n        for (t=0; t<this.state.tasks_by_day[this.state.selected_day-1].length; t++) {\n          const task = this.state.tasks_by_day[this.state.selected_day-1][t];\n          const task_duration = (((task.end_date-task.start_date)/1000)/60/60/24)*100;\n          const task_start = ((task.start_date - new Date(this.props.year, this.props.month, this.state.selected_day))/1000/60/60/24)*100;\n          day_cells.push((\n            <li\n              key={\"task-\"+t}\n              data-id={task.id}\n              data-project={task.project_data.id}\n              className={\n                \"task\"\n              }\n              style={{\n                left: task_start+\"%\",\n                maxWidth: task_duration+\"%\",\n                backgroundColor: task.project_data.color\n              }}\n              onClick={\n                this.handleTaskClick\n              }\n            >\n              <h4>\n                <i className={task.icon}></i>\n                <span><strong>{task.name}</strong></span>\n              </h4>\n              <div>{task.project_data.name}</div>\n            </li>\n          ));\n        }\n      }\n    }\n\n    return (\n      <ul className={(this.props.selected_day ? \"show-day\" : \"\")}>\n        <li className={\"day-schedule\"}\n          style={{\n            transformOrigin: ((this.state.selected_day/DaysInMonth(this.props.month, this.props.year))*100) + \"% 0\",\n            transition: \"opacity .5s ease \" + (Math.abs(this.props.index - this.props.selected_index) * .02) + \"s, transform .5s ease 1s\"\n          }}\n        >\n          <ul>\n            {day_cells}\n          </ul>\n        </li>\n        {cells}\n      </ul>\n    );\n  }\n}\n\nexport default Scheduler\n"]},"metadata":{},"sourceType":"module"}